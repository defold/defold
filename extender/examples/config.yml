context:
    dynamo_home: '/Users/chmu/tmp/dynamo-home'
    frameworks: ["Cocoa", "OpenGL", "OpenAL", "AGL", "IOKit", "Carbon", "CoreVideo", "Foundation", "AppKit", "Carbon"]
    includes: ['{{dynamo_home}}/include', '{{dynamo_home}}/ext/include']
    symbols: ["DefaultSoundDevice", "NullSoundDevice", "AudioDecoderWav", "CrashExt", "AudioDecoderStbVorbis",  "AudioDecoderTremolo"]

main: |
    #include <stdio.h>

    {{#symbols}}
    extern "C" void {{.}}();
    {{/symbols}}

    {{#ext.symbols}}
    extern "C" void {{.}}();
    {{/ext.symbols}}

    void dmExportedSymbols() {
        {{#symbols}}
        {{.}}();
        {{/symbols}}
        {{#ext.symbols}}
        {{.}}();
        {{/ext.symbols}}
    }

    extern int engine_main(int argc, char* argv[]);

    int main(int argc, char *argv[])
    {
        return engine_main(argc, argv);
    }

platforms:
  x86-osx:
    context:
        engineLibs: ["engine", "adtruthext", "facebookext", "iapext", "pushext", "iacext", "record", "gameobject", "ddf", "resource", "gamesys", "graphics", "physics", "BulletDynamics", "BulletCollision", "LinearMath", "Box2D", "render", "script", "lua", "extension", "hid", "input", "particle", "dlib", "dmglfw", "gui", "tracking", "crashext", "sound", "tremolo", "vpx"]
        libPaths: ["{{dynamo_home}}/lib/x86_64-darwin", "{{dynamo_home}}/ext/lib/x86_64-darwin"]

    exeExt: ''
    shlibRe: 'lib(.+).dylib'
    stlibRe: 'lib(.+).a'
    compileCmd: 'clang++ -c -m64 {{#includes}}-I{{.}} {{/includes}} {{#ext.includes}}-I{{.}} {{/ext.includes}} {{src}} -o{{tgt}}'
    linkCmd: clang++ -m64 -stdlib=libstdc++ -mmacosx-version-min=10.7 {{#src}}{{.}} {{/src}} -o {{tgt}} {{#ext.libPaths}}-L{{.}} {{/ext.libPaths}} {{#ext.libs}}-l{{.}} {{/ext.libs}} {{#frameworks}}-framework {{.}} {{/frameworks}} {{#libPaths}}-L{{.}} {{/libPaths}} {{#engineLibs}}-l{{.}} {{/engineLibs}}
    libCmd: 'ar rcs {{tgt}} {{#objs}}{{.}} {{/objs}}'
