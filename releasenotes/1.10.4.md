# Defold 1.10.4

## Summary
* __NEW__: ([#10627](https://github.com/defold/defold/pull/10627)) Added core engine support for runtime generation of SDF fonts (by JCash)
* __NEW__: ([#8759,#10868](https://github.com/defold/defold/pull/10892)) Improve callback invalidation (by AGulev)
* __NEW__: ([#10884](https://github.com/defold/defold/pull/10885)) Added an option to not create game objects for the bones of a model (by britzl)
* __NEW__: ([#10915](https://github.com/defold/defold/pull/10915)) Set size of pose matrix cache only once per frame if needed (by britzl)
* __NEW__: ([#6090](https://github.com/defold/defold/pull/10924)) Added `{{build-timestamp}}` token (by AGulev)
* __NEW__: ([#10947](https://github.com/defold/defold/pull/10966)) Moved GetAbsoluteIdentifier to dmSDK (by britzl)
* __NEW__: ([#10854](https://github.com/defold/defold/pull/10972)) Bob performance optimizations for sequential builds (by AGulev)
* __NEW__: ([#10974](https://github.com/defold/defold/pull/10974)) Allow debugging of macOS builds (by britzl)
* __NEW__: ([#8407,#6421,#6420](https://github.com/defold/defold/pull/10345)) Make scene grid configurable (by sprocketc)
* __NEW__: ([#6685](https://github.com/defold/defold/pull/10878)) Pull up or push down property overrides in the editor (by matgis)
* __NEW__: ([#10821](https://github.com/defold/defold/pull/10875)) Fix unnecessary notifications for conflicting folders (by vlaaad)
* __NEW__: ([#10857](https://github.com/defold/defold/pull/10874)) Enhance curve colors (by sprocketc)
* __NEW__: ([#10865](https://github.com/defold/defold/pull/10900)) Fix layout restore on Linux (by sprocketc)
* __NEW__: ([#10235](https://github.com/defold/defold/pull/10263)) Add scene context menu to editor scripts (by sprocketc)
* __NEW__: ([#10740,#9306](https://github.com/defold/defold/pull/10941)) Edit node id in outline (by sprocketc)
* __NEW__: ([#10725](https://github.com/defold/defold/pull/10968)) Allow users to cancel an ongoing build in the editor (by matgis)
* __NEW__: ([#10949](https://github.com/defold/defold/pull/10978)) Added new LiveUpdate publisher mode "Folder" (by AGulev)
* __NEW__: ([#10739](https://github.com/defold/defold/pull/10986)) Asset Picker optimizations (by matgis)
* __FIX__: ([#10980](https://github.com/defold/defold/pull/10980)) Reworked profiler api to better support multiple imlpementations at once (by JCash)
* __FIX__: ([#8320,#4675](https://github.com/defold/defold/pull/10901)) Fixed issue when using a resource from a library in custom `custom_resources` (by AGulev)
* __FIX__: ([#10897](https://github.com/defold/defold/pull/10897)) Fix glitches on the first frame of the GPU-skinned instanced animation right after spawn. (by AGulev)
* __FIX__: ([#10910](https://github.com/defold/defold/pull/10910)) Optimize Bone Matrix Texture Packing for Skinned Models (4x3 Matrix Storage, Memory & Bandwidth Savings) (by AGulev)
* __FIX__: ([#10771](https://github.com/defold/defold/pull/10923)) Fix memory leak when using custom vertex attributes (by AGulev)
* __FIX__: ([#8767](https://github.com/defold/defold/pull/10933)) Make sure the Windows bundle works when run via Proton (by AGulev)
* __FIX__: ([#10938](https://github.com/defold/defold/pull/10938)) Improved the callstack generation for Windows crashes (by JCash)
* __FIX__: ([#10953](https://github.com/defold/defold/pull/10953)) Added WebGPUGetInstance and WebGPUGetAdapter to dmsdk/graphics/graphics_webgpu.h (by JCash)
* __FIX__: ([#10958](https://github.com/defold/defold/pull/10958)) Fixed a Windows-specific issue causing assertion failures with `luaL_error`-based functions (by AGulev)
* __FIX__: ([#10965](https://github.com/defold/defold/pull/10965)) Faster LiveUpdate build (by AGulev)
* __FIX__: ([#10976](https://github.com/defold/defold/pull/10982)) Change Android bundling process to be compatible with the new "Support 16 KB page sizes" requirement. (by AGulev)
* __FIX__: ([#10951](https://github.com/defold/defold/pull/10985)) Fix crash when using invalid render target settings key (by britzl)
* __FIX__: ([#10957](https://github.com/defold/defold/pull/10977)) Do not render mesh if it was deleted in the same frame as it was created (by britzl)
* __FIX__: ([#10987](https://github.com/defold/defold/pull/10988)) Fix issue where the same image can't be used more than once in a cubemap (by AGulev)
* __FIX__: ([#10989](https://github.com/defold/defold/pull/10989)) Resolve dependencies faster when bundling using Bob (by AGulev)
* __FIX__: ([#10684](https://github.com/defold/defold/pull/10881)) Add option to disable OpenGL ES 2.0 shader compilation (by vlaaad)
* __FIX__: ([#10918](https://github.com/defold/defold/pull/10918)) Edit go files using editor scripts (by vlaaad)
* __FIX__: ([#10925](https://github.com/defold/defold/pull/10925)) Edit collections using editor scripts (by vlaaad)
* __FIX__: ([#10932](https://github.com/defold/defold/pull/10940)) Fix exceptions caused by changing file extensions during renames (by vlaaad)
* __FIX__: ([#10920](https://github.com/defold/defold/pull/10943)) Split physics app manifest settings into 2D and 3D (by vlaaad)
* __FIX__: ([#10970](https://github.com/defold/defold/pull/10991)) Filter out nil items from tree selection (by sprocketc)

## Engine
__NEW__: ([#8759,#10868](https://github.com/defold/defold/pull/10892)) __'Improve callback invalidation'__ by AGulev
Ensure that callbacks properly track whether they are still valid and avoid situations where the wrong callback could be accidentally destroyed under certain conditions.

__NEW__: ([#10884](https://github.com/defold/defold/pull/10885)) __'Added an option to not create game objects for the bones of a model'__ by britzl
The model component now has an option to not create one game object per bone of a skeleton. When bone creation is disabled it is possible to have a high number of animated and skinned models in a scene (example with 15k models):

![image](https://github.com/user-attachments/assets/804368a5-d5c3-4696-a3bd-d7687778c6ac)

![image](https://github.com/user-attachments/assets/5106eddd-ffbb-4b2c-91b6-2d3567935b18)

In addition to the above change the engine will now also warn if the bone pose matrix texture cache is too small so that the developer can take action and increase the max size in game.project (`model.max_bone_matrix_texture_width` and `model.max_bone_matrix_texture_height`).



##

__NEW__: ([#10627](https://github.com/defold/defold/pull/10627)) __'Added core engine support for runtime generation of SDF fonts'__ by JCash
In this release we've added support for runtime generation of signed distance field fonts.
The main benefits are smaller bundle size, and runtime memory footprint. The drawback is very slightly longer load times.

It is currently an opt-in, and you can enable it by setting the project variable `font.runtime_generation`.
Our goal is to make this our default way of generating fonts, so we'd like our users to please test the this feature out and report any issues.

For the visual before/after comparisons, both the old and new distance field generators have artefacts, and we don't see any real difference in improvement or degradation. They're just different, which is expected for a single channel SDF implementation.

The font glyph can prewarm the glyph cache if you've deselected "All Characters" on your font, and specified a small subset of characters.

At runtime, you can also add/remove glyphs to the font dynamically by calling `font.add_glyphs()`/`font.remove_glyphs()`

You can read more about usage of runtime fonts in the [font documentation](https://defold.com/manuals/font/).

__NEW__: ([#10915](https://github.com/defold/defold/pull/10915)) __'Set size of pose matrix cache only once per frame if needed'__ by britzl
The pose matrix cache in rig.cpp was resized once per rig instance. This caused a big slowdown when a large number of instances were added in a single frame. The pose matrix size is now calculated once per frame and the cache itself is resized only once per frame if needed.

__NEW__: ([#6090](https://github.com/defold/defold/pull/10924)) __'Added `{{build-timestamp}}` token'__ by AGulev
New token `{{build-timestamp}}` added, which can be used in manifests or the `index.html` template.

__NEW__: ([#10947](https://github.com/defold/defold/pull/10966)) __'Moved GetAbsoluteIdentifier to dmSDK'__ by britzl
Moved `dmGameObject::GetAbsoluteIdentifier(HInstance instance, const char* identifier)` to dmSDK. The function is used to get the absolute identifier relative to a game object instance. The returned identifier is the representation of the qualified name, i.e. the path from root-collection to the sub-collection which the instance belongs to.

__NEW__: ([#10854](https://github.com/defold/defold/pull/10972)) __'Bob performance optimizations for sequential builds'__ by AGulev
This fix speeds up Bob.jar initialization, which is especially useful for sequential builds without many changes (e.g. Cmd+M to Build HTML5 from the editor, or bundling).  
* About 4 times faster initialization. In the test setup, it's 400 ms vs 1600 ms (for a project with a large file count, it's 3.5 s vs 20 s)  
* Speed-up of the task creation stage for a small project in the test setup: 900 ms vs 2000 ms (for a large project, about 5%)

__NEW__: ([#10974](https://github.com/defold/defold/pull/10974)) __'Allow debugging of macOS builds'__ by britzl
This change adds the `com.apple.security.get-task-allow` entitlement to debug versions of macOS bundles to allow debugging using Xcode Instruments.

__FIX__: ([#10980](https://github.com/defold/defold/pull/10980)) __'Reworked profiler api to better support multiple imlpementations at once'__ by JCash
We have updated our profiling backend to support multiple listeners.
The listeners are implemented using extensions, allowing users to add their own profiler (see [extension-profile-counters](https://github.com/defold/extension-profile-counters)).

* The "basic" one, that shows in game profiling, is included on all platforms.
* For desktop and mobile platforms, you also have Remotery support.
* For HTML5, we've added a new profiler listener, using the web Performance api.
To minimize the overhead on HTML5, the Performance API profiler is disabled by default.
Enable it with the project setting `html5.performance_timeline_enabled = 1`

## How to use the HTML5 Performance profiler

1. Enable the `html5.performance_timeline_enabled` option in the `game.project`
1. Launch the `Developer Tools` in Chrome. (<kbd>CMD+Shift+I</kbd> on macOS)
1. Under the `Performance` tab, press the `Record` button. (<kbd>CMD+E</kbd> on macOS)
1. Stop the recording, and it will display the frame profile data in the view.

_Start the recording..._
<img width="1512" height="815" alt="Screenshot 2025-07-18 at 14 35 52" src="https://github.com/user-attachments/assets/081ca866-6421-4b82-8c33-b3ca7bc29e21" />

_Stop the recording..._
<img width="388" height="161" alt="Screenshot 2025-07-18 at 14 38 05" src="https://github.com/user-attachments/assets/aa70d0ad-4e32-4304-b22c-de9e96b51c38" />

_The recording is displayed:_
<img width="1512" height="982" alt="Screenshot 2025-07-18 at 14 38 11" src="https://github.com/user-attachments/assets/ed852c7b-b54f-48ec-a39e-0cad7c610a5a" />

_Zoom into the recording, to inspect the timing values:_
<img width="1512" height="982" alt="Screenshot 2025-07-18 at 14 38 54" src="https://github.com/user-attachments/assets/c02917e8-73d7-404e-a35a-9741c5b6562a" />


## Migration

For most users, who don't use custom app manifests or have disabled/enabled the profiler.

For the more technical users, if you have a custom app manifest, you may need to update your manifest as we have updated the profiler libraries.

Simplest way to update is to create an empty appmanifest, disable profiler in that appmanifest, and then compare with your own custom one for any discrepancies. All libraries and symbols should have the name "profile", so should be easy to find.

Here is a list of the relevant libraries and symbols, and which platform they're targeting:

* all platforms:
    * `profilerext` - library containing symbols:
        * `ProfilerExt` - the `profile.*`Lua module
        * `ProfilerBasic` - the in game profiler view

* desktop + mobile:
    * profiler_remotery
        * `ProfilerRemotery` - containing the `Remotery` profiler

* `html5`
    * `profiler_js` - profiler using the Web Performance API
        * symbol:`ProfilerJS` 

Note: the `remotery` library has been removed. That functionality is now contained within `profiler_remotery`.

__FIX__: ([#8320,#4675](https://github.com/defold/defold/pull/10901)) __'Fixed issue when using a resource from a library in custom `custom_resources`'__ by AGulev
Now using a directory or a resource from a library (connected as a dependency) is possible not only in the editor, but also when bundling.

__FIX__: ([#10897](https://github.com/defold/defold/pull/10897)) __'Fix glitches on the first frame of the GPU-skinned instanced animation right after spawn.'__ by AGulev
It also increases performance for GPU-skinned instanced animation by about 30–50%, depending on the platform and the specific case.

__FIX__: ([#10910](https://github.com/defold/defold/pull/10910)) __'Optimize Bone Matrix Texture Packing for Skinned Models (4x3 Matrix Storage, Memory & Bandwidth Savings)'__ by AGulev
Improved performance and reduced memory usage for skinned models:
The engine now uses a more efficient way to store bone matrices for animated models, reducing the required memory and GPU bandwidth by 25%. This can result in better performance (10-15%), especially when using many animated characters.

__FIX__: ([#10771](https://github.com/defold/defold/pull/10923)) __'Fix memory leak when using custom vertex attributes'__ by AGulev


__FIX__: ([#8767](https://github.com/defold/defold/pull/10933)) __'Make sure the Windows bundle works when run via Proton'__ by AGulev
Fixed an issue where running a Windows project bundle on Linux via Proton would close with `Could not find gl function 'glGenPrograms'`.

__FIX__: ([#10938](https://github.com/defold/defold/pull/10938)) __'Improved the callstack generation for Windows crashes'__ by JCash
Fixed a double crash during callstack writing that messed up the text representation of the crash.

__FIX__: ([#10953](https://github.com/defold/defold/pull/10953)) __'Added WebGPUGetInstance and WebGPUGetAdapter to dmsdk/graphics/graphics_webgpu.h'__ by JCash
This allows for easier checking of the GPU capabilities at runtime.

__FIX__: ([#10958](https://github.com/defold/defold/pull/10958)) __'Fixed a Windows-specific issue causing assertion failures with `luaL_error`-based functions'__ by AGulev
Fixed an issue where functions like `CheckVector3`, `CheckHashOrString`, etc., that use `luaL_error` or similar functions may behave differently when used in extensions and compiled on Windows.  
In combination with `DM_LUA_STACK_CHECK`, this could result in an assertion failure.

__FIX__: ([#10965](https://github.com/defold/defold/pull/10965)) __'Faster LiveUpdate build'__ by AGulev
Use multithreaded setup when creating the LiveUpdate archive to speed up the build.  
It speeds up LiveUpdate archive creation by about 50%.

__FIX__: ([#10976](https://github.com/defold/defold/pull/10982)) __'Change Android bundling process to be compatible with the new "Support 16 KB page sizes" requirement.'__ by AGulev
⚠️ This fix changes the default for `android.extract_native_libs` to `false`, which is a requirement for API 35.  
It will increase your AAB/APK size, but according to https://developer.android.com/studio/debug/apk-analyzer,  
it doesn't affect the download size from the Play Store, because it uses its own compression:
<img width="1788" height="796" alt="CleanShot 2025-07-18 at 15 26 17@2x" src="https://github.com/user-attachments/assets/0d8b405d-3bde-4f58-ab67-662e866e6e9f" />

__FIX__: ([#10951](https://github.com/defold/defold/pull/10985)) __'Fix crash when using invalid render target settings key'__ by britzl
The engine would crash with an unbalanced Lua stack if an invalid key was used when creating a render target.

__FIX__: ([#10957](https://github.com/defold/defold/pull/10977)) __'Do not render mesh if it was deleted in the same frame as it was created'__ by britzl
If a mesh component is created and then deleted in the same frame (for instance by calling `go.delete()` in `init()`) it should not be rendered.

__FIX__: ([#10987](https://github.com/defold/defold/pull/10988)) __'Fix issue where the same image can't be used more than once in a cubemap'__ by AGulev
Fixed issue where attempting to bundle a project with a cubemap that uses the same image more than once resulted in a null pointer exception.

__FIX__: ([#10989](https://github.com/defold/defold/pull/10989)) __'Resolve dependencies faster when bundling using Bob'__ by AGulev
With this change, Bob uses two threads to resolve dependencies. Two simultaneous connections to a remote server will not be treated as "Too many requests" but will double the speed of dependency resolution (it depends on the connection, but even when all the dependencies are in the cache, cache checking goes twice as fast).


## Editor
__NEW__: ([#8407,#6421,#6420](https://github.com/defold/defold/pull/10345)) __'Make scene grid configurable'__ by sprocketc
![customizable-grid](https://github.com/user-attachments/assets/99958c23-54be-4eaa-acef-283383b2f96d)

The grid toggle was moved from the visibility dropdown, at the top level of the scene toolbar. A dedicated grid options dropdown was added next to the toggle, to allow users to configure the size per axis, the visibility plane, the color, and the opacity, on a project by project basis. A default keyboard shortcut (`Ctrl+G`) that toggles the grid was also introduced.

__NEW__: ([#6685](https://github.com/defold/defold/pull/10878)) __'Pull up or push down property overrides in the editor'__ by matgis
* The Clear Override button next to an overridden property in the Properties View has been moved into a dropdown menu available by clicking on the property label.
* You can now pull up property overrides to ancestors, or push down overrides to descendants in the editor. These commands are available from the property label dropdown menu, or from the context menu when right-clicking on an overridden object in the Outline View.
* Pull Up and Push Down Overrides buttons have been added to the Search Results view that appears when Show Overrides... is selected for an object or property.
* Fixed various small positioning and size issues around controls used in the Properties View.

__NEW__: ([#10821](https://github.com/defold/defold/pull/10875)) __'Fix unnecessary notifications for conflicting folders'__ by vlaaad


__NEW__: ([#10857](https://github.com/defold/defold/pull/10874)) __'Enhance curve colors'__ by sprocketc


__NEW__: ([#10865](https://github.com/defold/defold/pull/10900)) __'Fix layout restore on Linux'__ by sprocketc


__NEW__: ([#10235](https://github.com/defold/defold/pull/10263)) __'Add scene context menu to editor scripts'__ by sprocketc


__NEW__: ([#10740,#9306](https://github.com/defold/defold/pull/10941)) __'Edit node id in outline'__ by sprocketc
![rename-id](https://github.com/user-attachments/assets/083dcbbc-2794-4eeb-8850-6a66f91b4d27)

Node ids can be edited in place on the outline tree, by pressing `F2` or with a delayed double click. The keyboard shortcut is customizable.

__NEW__: ([#10725](https://github.com/defold/defold/pull/10968)) __'Allow users to cancel an ongoing build in the editor'__ by matgis
You can now cancel the build process in the editor by clicking the Stop button next to the progress indicator in the status bar.

__NEW__: ([#10949](https://github.com/defold/defold/pull/10978)) __'Added new LiveUpdate publisher mode "Folder"'__ by AGulev
Added new LiveUpdate publisher mode "Folder" and settings for this mode.  
This mode may be useful in case you need to post-process files before upload and plan to pack them into an archive yourself.

__NEW__: ([#10739](https://github.com/defold/defold/pull/10986)) __'Asset Picker optimizations'__ by matgis
Shortened the time it takes before you see the results when filtering in the Asset Picker.

__FIX__: ([#10684](https://github.com/defold/defold/pull/10881)) __'Add option to disable OpenGL ES 2.0 shader compilation'__ by vlaaad
New `game.project` property `shader.exclude_gles_sm100` allows skipping shader compilation to OpenGL ES 2.0 / WebGL 1.0 (GLES SM100) language.

__FIX__: ([#10918](https://github.com/defold/defold/pull/10918)) __'Edit go files using editor scripts'__ by vlaaad
It's now possible to edit components of a game object file using editor scripts. The components come in 2 flavors: referenced and embedded. Referenced components use type `reference` and act as references to other resources, only allowing overrides of go properties defined in scripts. Embedded components use types like `sprite`, `label`, etc., and allow editing of all properties defined in the component type, as well as adding sub-components like shapes of collision objects. For example, you can use the following code to set up a game object:
```lua
editor.transact({
    editor.tx.add("/npc.go", "components", {
        type = "sprite",
        id = "view"
    }),
    editor.tx.add("/npc.go", "components", {
        type = "collisionobject",
        id = "collision",
        shapes = {
            {
                type = "shape-type-box",
                dimensions = {32, 32, 32}
            }
        }
    }),
    editor.tx.add("/npc.go", "components", {
        type = "reference",
        path = "/npc.script"
        id = "controller",
        __hp = 100 -- set a go property defined in the script
    })
})
```

###

__FIX__: ([#10925](https://github.com/defold/defold/pull/10925)) __'Edit collections using editor scripts'__ by vlaaad
Now it's possible to edit collections using editor scripts. You can add game objects (embedded or referenced) and collections (referenced). For example:
```lua
local coll = "/char.collection"
editor.transact({
    editor.tx.add(coll, "children", {
        -- embbedded game object
        type = "go",
        id = "root",
        children = {
            {
                -- referenced game object
                type = "go-reference",
                path = "/char-view.go"
                id = "view"
            },
            {
                -- referenced collection
                type = "collection-reference",
                path = "/body-attachments.collection"
                id = "attachments"
            }
        },
        -- embedded gos can also have components
        components = {
            {
                type = "collisionobject",
                id = "collision",
                shapes = {
                    {type = "shape-type-box", dimensions = {2.5, 2.5, 2.5}}
                }
            },
            {
                type = "component-reference",
                id = "controller",
                path = "/char.script",
                __hp = 100 -- set a go property defined in the script
            }
        }
    })
})
```

__FIX__: ([#10932](https://github.com/defold/defold/pull/10940)) __'Fix exceptions caused by changing file extensions during renames'__ by vlaaad


__FIX__: ([#10920](https://github.com/defold/defold/pull/10943)) __'Split physics app manifest settings into 2D and 3D'__ by vlaaad


__FIX__: ([#10970](https://github.com/defold/defold/pull/10991)) __'Filter out nil items from tree selection'__ by sprocketc


